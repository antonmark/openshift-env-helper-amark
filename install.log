#TODO Add check repo/rpms later
# yum -y install ansible git
#cp ocp4-helpernode/docs/examples/vars.yaml /home/cloud-user/openshift-env-helper/ocp4-workingdir/ 
echo "Nothing to do"
Nothing to do
# Define Network 
pwd
/home/cloud-user/openshift-env-helper
wget -P /home/cloud-user/openshift-env-helper/ocp4-workingdir https://raw.githubusercontent.com/RedHatOfficial/ocp4-helpernode/master/docs/examples/virt-net.xml
--2022-01-19 22:19:15--  https://raw.githubusercontent.com/RedHatOfficial/ocp4-helpernode/master/docs/examples/virt-net.xml
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.108.133, 185.199.111.133, 185.199.109.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.108.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 284 [text/plain]
Saving to: ‘/home/cloud-user/openshift-env-helper/ocp4-workingdir/virt-net.xml’

     0K                                                       100% 16.8M=0s

2022-01-19 22:19:15 (16.8 MB/s) - ‘/home/cloud-user/openshift-env-helper/ocp4-workingdir/virt-net.xml’ saved [284/284]

sed -i -e "s@<name>openshift4</name>@<name>openshift4</name>@g" /home/cloud-user/openshift-env-helper/ocp4-workingdir/virt-net.xml
sed -i -e "s@<bridge name='openshift4' stp='on' delay='0'/>@<bridge name='openshift4' stp='on' delay='0'/>@g" /home/cloud-user/openshift-env-helper/ocp4-workingdir/virt-net.xml
virsh net-define --file /home/cloud-user/openshift-env-helper/ocp4-workingdir/virt-net.xml
Network openshift4 defined from /home/cloud-user/openshift-env-helper/ocp4-workingdir/virt-net.xml

virsh net-autostart openshift4
Network openshift4 marked as autostarted

virsh net-start openshift4
Network openshift4 started

##TODO Why cannot sshkey be inserted the vm?
# Deploy Helper node
wget https://raw.githubusercontent.com/RedHatOfficial/ocp4-helpernode/master/docs/examples/helper-ks8.cfg -O /home/cloud-user/openshift-env-helper/ocp4-workingdir/helper-ks.cfg
--2022-01-19 22:19:16--  https://raw.githubusercontent.com/RedHatOfficial/ocp4-helpernode/master/docs/examples/helper-ks8.cfg
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.110.133, 185.199.109.133, 185.199.111.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.110.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 1537 (1.5K) [text/plain]
Saving to: ‘/home/cloud-user/openshift-env-helper/ocp4-workingdir/helper-ks.cfg’

     0K .                                                     100% 17.6M=0s

2022-01-19 22:19:16 (17.6 MB/s) - ‘/home/cloud-user/openshift-env-helper/ocp4-workingdir/helper-ks.cfg’ saved [1537/1537]

if [ ! -f /var/lib/libvirt/ISO//CentOS-8-x86_64-1905-dvd1.iso ]; then \
  wget -P /var/lib/libvirt/ISO/ http://ftp.iij.ad.jp/pub/linux/centos-vault/centos/8.0.1905/isos/x86_64/CentOS-8-x86_64-1905-dvd1.iso; \
fi
# Modify dnsnameserver
sed -i -e "s/8.8.8.8/192.168.7.1/g" /home/cloud-user/openshift-env-helper/ocp4-workingdir/helper-ks.cfg
sed -i -e "s/192.168.7.77/192.168.7.77/g" /home/cloud-user/openshift-env-helper/ocp4-workingdir/helper-ks.cfg
sed -i -e "s/192.168.7.1/192.168.7.1/g" /home/cloud-user/openshift-env-helper/ocp4-workingdir/helper-ks.cfg
# Add ssh key to helper-ks.cfg
#ansible localhost -m lineinfile -a "path=/home/cloud-user/openshift-env-helper/ocp4-workingdir/helper-ks.cfg insertafter='rootpw --plaintext changeme' line='sshkey --username=root ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDilicABEI66jI4U/ICXzSUgg/0G+ij9ShnO0G8EgG/MWZCmWQ96dGng/i5/MAWoaQwG55i3Y1Fbgpr35jKXOLxEZRJabR78BTtcyDPABivlk5nWOUUrAmzBHQ/+FNyivk0iHTigW1MP2lioNKbxEQqEIAZxkeB4kaSCDteuxLICijF6QpWAcd3D6zzf0qn5HV+RB93tOceaiU6m8aYNMUifyoAjLuyGGi1JSB+6O7XHs2ati2SxusQryq2FKP0xKtBubdUMIfQLKI7VX1Xv8pkCU5q82qnZps5TYKSvA7Ogypkref3DeTwOTJT7zj9WC7c5e1gA5wCFXAoTcNjmEeb hkaneko@hkaneko-mac.local'"
virt-install --name=ocp4-aHelper --vcpus=2 --ram=4096 \
--disk path=/var/lib/libvirt/images/ocp4-aHelper.qcow2,bus=virtio,size=50 \
--os-variant centos8 --network network=openshift4,model=virtio \
--boot hd,menu=on --location /var/lib/libvirt/ISO/CentOS-8-x86_64-1905-dvd1.iso \
--initrd-inject /home/cloud-user/openshift-env-helper/ocp4-workingdir/helper-ks.cfg --extra-args "inst.ks=file:/helper-ks.cfg" --noautoconsole

Starting install...
Retrieving file vmlinuz...                                  | 7.5 MB  00:00     
Retrieving file initrd.img...                               |  58 MB  00:00     
Allocating 'ocp4-aHelper.qcow2'                             |  50 GB  00:00     
Domain installation still in progress. You can reconnect to 
the console to complete the installation process.
## Cant exit loop with some reasons.. 
# Wait until helper node is stopped.
./scripts/check_helper_running.sh ocp4-aHelper
...............................................##TODO it is not good
virsh start ocp4-aHelper
Domain ocp4-aHelper started

# Wait for succeeding connect with ssh
./scripts/wait_until_helper_running.sh 192.168.7.77 $HOME/.ssh/id_rsa.pub
../scripts/create_masters.sh
Domain ocp4-master0 defined from ../ocp4-workingdir/ocp4-master0.xml

Domain ocp4-master1 defined from ../ocp4-workingdir/ocp4-master1.xml

Domain ocp4-master2 defined from ../ocp4-workingdir/ocp4-master2.xml

./scripts/create_bootstrap.sh
Domain ocp4-bootstrap defined from ../ocp4-workingdir/ocp4-bootstrap.xml

./scripts/create_workers.sh 2
Domain ocp4-worker0 defined from ../ocp4-workingdir/ocp4-worker0.xml

Domain ocp4-worker1 defined from ../ocp4-workingdir/ocp4-worker1.xml

./scripts/create_odf.sh
Domain ocp4-odf0 defined from ../ocp4-workingdir/ocp4-odf0.xml

Domain ocp4-odf1 defined from ../ocp4-workingdir/ocp4-odf1.xml

Domain ocp4-odf2 defined from ../ocp4-workingdir/ocp4-odf2.xml

ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 yum -y install https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm
CentOS-8 - AppStream                            3.0 MB/s | 8.4 MB     00:02    
CentOS-8 - Base                                 2.6 MB/s | 4.6 MB     00:01    
CentOS-8 - Extras                               4.5 kB/s |  10 kB     00:02    
epel-release-latest-8.noarch.rpm                 13 kB/s |  23 kB     00:01    
Dependencies resolved.
================================================================================
 Package             Arch          Version            Repository           Size
================================================================================
Installing:
 epel-release        noarch        8-13.el8           @commandline         23 k

Transaction Summary
================================================================================
Install  1 Package

Total size: 23 k
Installed size: 35 k
Downloading Packages:
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Installing       : epel-release-8-13.el8.noarch                           1/1 
  Running scriptlet: epel-release-8-13.el8.noarch                           1/1 
  Verifying        : epel-release-8-13.el8.noarch                           1/1 

Installed:
  epel-release-8-13.el8.noarch                                                  

Complete!
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 yum -y install ansible git
Extra Packages for Enterprise Linux Modular 8 - 594 kB/s | 979 kB     00:01    
Extra Packages for Enterprise Linux 8 - x86_64  9.3 MB/s |  11 MB     00:01    
Dependencies resolved.
================================================================================
 Package                    Arch   Version                      Repository
                                                                           Size
================================================================================
Installing:
 git                        x86_64 2.27.0-1.el8                 AppStream 164 k
 ansible                    noarch 2.9.27-1.el8                 epel       17 M
Upgrading:
 chkconfig                  x86_64 1.19.1-1.el8                 BaseOS    198 k
 platform-python-pip        noarch 9.0.3-20.el8                 BaseOS    1.7 M
 platform-python-setuptools noarch 39.2.0-6.el8                 BaseOS    632 k
Installing dependencies:
 git-core                   x86_64 2.27.0-1.el8                 AppStream 5.7 M
 git-core-doc               noarch 2.27.0-1.el8                 AppStream 2.5 M
 perl-Digest                noarch 1.17-395.el8                 AppStream  27 k
 perl-Digest-MD5            x86_64 2.55-396.el8                 AppStream  37 k
 perl-Error                 noarch 1:0.17025-2.el8              AppStream  46 k
 perl-Git                   noarch 2.27.0-1.el8                 AppStream  77 k
 perl-Net-SSLeay            x86_64 1.88-1.module_el8.3.0+410+ff426aa3
                                                                AppStream 379 k
 perl-TermReadKey           x86_64 2.37-7.el8                   AppStream  40 k
 perl-URI                   noarch 1.73-3.el8                   AppStream 116 k
 perl-libnet                noarch 3.11-3.el8                   AppStream 121 k
 python3-babel              noarch 2.5.1-7.el8                  AppStream 4.8 M
 python3-jinja2             noarch 2.10.1-3.el8                 AppStream 538 k
 python3-jmespath           noarch 0.9.0-11.el8                 AppStream  45 k
 python3-markupsafe         x86_64 0.23-19.el8                  AppStream  39 k
 python3-pip                noarch 9.0.3-20.el8                 AppStream  20 k
 python3-pyasn1             noarch 0.3.7-6.el8                  AppStream 126 k
 python3-pytz               noarch 2017.2-9.el8                 AppStream  54 k
 python36                   x86_64 3.6.8-38.module_el8.5.0+895+a459eca8
                                                                AppStream  19 k
 emacs-filesystem           noarch 1:26.1-7.el8                 BaseOS     70 k
 perl-Carp                  noarch 1.42-396.el8                 BaseOS     30 k
 perl-Data-Dumper           x86_64 2.167-399.el8                BaseOS     58 k
 perl-Encode                x86_64 4:2.97-3.el8                 BaseOS    1.5 M
 perl-Errno                 x86_64 1.28-420.el8                 BaseOS     76 k
 perl-Exporter              noarch 5.72-396.el8                 BaseOS     34 k
 perl-File-Path             noarch 2.15-2.el8                   BaseOS     38 k
 perl-File-Temp             noarch 0.230.600-1.el8              BaseOS     63 k
 perl-Getopt-Long           noarch 1:2.50-4.el8                 BaseOS     63 k
 perl-HTTP-Tiny             noarch 0.074-1.el8                  BaseOS     58 k
 perl-IO                    x86_64 1.38-420.el8                 BaseOS    142 k
 perl-MIME-Base64           x86_64 3.15-396.el8                 BaseOS     31 k
 perl-PathTools             x86_64 3.74-1.el8                   BaseOS     90 k
 perl-Pod-Escapes           noarch 1:1.07-395.el8               BaseOS     20 k
 perl-Pod-Perldoc           noarch 3.28-396.el8                 BaseOS     86 k
 perl-Pod-Simple            noarch 1:3.35-395.el8               BaseOS    213 k
 perl-Pod-Usage             noarch 4:1.69-395.el8               BaseOS     34 k
 perl-Scalar-List-Utils     x86_64 3:1.49-2.el8                 BaseOS     68 k
 perl-Socket                x86_64 4:2.027-3.el8                BaseOS     59 k
 perl-Storable              x86_64 1:3.11-3.el8                 BaseOS     98 k
 perl-Term-ANSIColor        noarch 4.06-396.el8                 BaseOS     46 k
 perl-Term-Cap              noarch 1.17-395.el8                 BaseOS     23 k
 perl-Text-ParseWords       noarch 3.30-395.el8                 BaseOS     18 k
 perl-Text-Tabs+Wrap        noarch 2013.0523-395.el8            BaseOS     24 k
 perl-Time-Local            noarch 1:1.280-1.el8                BaseOS     34 k
 perl-Unicode-Normalize     x86_64 1.25-396.el8                 BaseOS     82 k
 perl-constant              noarch 1.33-396.el8                 BaseOS     25 k
 perl-interpreter           x86_64 4:5.26.3-420.el8             BaseOS    6.3 M
 perl-libs                  x86_64 4:5.26.3-420.el8             BaseOS    1.6 M
 perl-macros                x86_64 4:5.26.3-420.el8             BaseOS     72 k
 perl-parent                noarch 1:0.237-1.el8                BaseOS     20 k
 perl-podlators             noarch 4.11-1.el8                   BaseOS    118 k
 perl-threads               x86_64 1:2.21-2.el8                 BaseOS     61 k
 perl-threads-shared        x86_64 1.58-2.el8                   BaseOS     48 k
 python3-pyyaml             x86_64 3.12-12.el8                  BaseOS    193 k
 python3-setuptools         noarch 39.2.0-6.el8                 BaseOS    163 k
 libsodium                  x86_64 1.0.18-2.el8                 epel      162 k
 python3-bcrypt             x86_64 3.1.6-2.el8.1                epel       44 k
 python3-pynacl             x86_64 1.3.0-5.el8                  epel      100 k
 sshpass                    x86_64 1.06-9.el8                   epel       27 k
Installing weak dependencies:
 perl-IO-Socket-IP          noarch 0.39-5.el8                   AppStream  47 k
 perl-IO-Socket-SSL         noarch 2.066-4.module_el8.3.0+410+ff426aa3
                                                                AppStream 298 k
 perl-Mozilla-CA            noarch 20160104-7.module_el8.3.0+416+dee7bcef
                                                                AppStream  15 k
 python3-paramiko           noarch 2.4.3-1.el8                  epel      289 k
Enabling module streams:
 perl-IO-Socket-SSL                2.066                                       
 perl-libwww-perl                  6.34                                        
 python36                          3.6                                         

Transaction Summary
================================================================================
Install  64 Packages
Upgrade   3 Packages

Total download size: 47 M
Downloading Packages:
(1/67): git-core-doc-2.27.0-1.el8.noarch.rpm    9.8 MB/s | 2.5 MB     00:00    
(2/67): git-2.27.0-1.el8.x86_64.rpm             624 kB/s | 164 kB     00:00    
(3/67): perl-Digest-1.17-395.el8.noarch.rpm     3.9 MB/s |  27 kB     00:00    
(4/67): perl-Error-0.17025-2.el8.noarch.rpm     4.9 MB/s |  46 kB     00:00    
(5/67): perl-Digest-MD5-2.55-396.el8.x86_64.rpm 2.4 MB/s |  37 kB     00:00    
(6/67): perl-Git-2.27.0-1.el8.noarch.rpm        6.6 MB/s |  77 kB     00:00    
(7/67): perl-IO-Socket-IP-0.39-5.el8.noarch.rpm 4.2 MB/s |  47 kB     00:00    
(8/67): perl-Mozilla-CA-20160104-7.module_el8.3 2.5 MB/s |  15 kB     00:00    
(9/67): perl-IO-Socket-SSL-2.066-4.module_el8.3  11 MB/s | 298 kB     00:00    
(10/67): perl-TermReadKey-2.37-7.el8.x86_64.rpm 4.9 MB/s |  40 kB     00:00    
(11/67): perl-URI-1.73-3.el8.noarch.rpm         8.7 MB/s | 116 kB     00:00    
(12/67): perl-Net-SSLeay-1.88-1.module_el8.3.0+ 8.8 MB/s | 379 kB     00:00    
(13/67): perl-libnet-3.11-3.el8.noarch.rpm      6.4 MB/s | 121 kB     00:00    
(14/67): python3-jinja2-2.10.1-3.el8.noarch.rpm  11 MB/s | 538 kB     00:00    
(15/67): python3-jmespath-0.9.0-11.el8.noarch.r 5.0 MB/s |  45 kB     00:00    
(16/67): python3-markupsafe-0.23-19.el8.x86_64. 5.6 MB/s |  39 kB     00:00    
(17/67): python3-pip-9.0.3-20.el8.noarch.rpm    2.3 MB/s |  20 kB     00:00    
(18/67): python3-pyasn1-0.3.7-6.el8.noarch.rpm   10 MB/s | 126 kB     00:00    
(19/67): python3-pytz-2017.2-9.el8.noarch.rpm   6.1 MB/s |  54 kB     00:00    
(20/67): python36-3.6.8-38.module_el8.5.0+895+a 3.2 MB/s |  19 kB     00:00    
(21/67): emacs-filesystem-26.1-7.el8.noarch.rpm 1.6 MB/s |  70 kB     00:00    
(22/67): perl-Carp-1.42-396.el8.noarch.rpm      1.4 MB/s |  30 kB     00:00    
(23/67): perl-Data-Dumper-2.167-399.el8.x86_64. 2.7 MB/s |  58 kB     00:00    
(24/67): git-core-2.27.0-1.el8.x86_64.rpm       9.6 MB/s | 5.7 MB     00:00    
(25/67): perl-Errno-1.28-420.el8.x86_64.rpm     844 kB/s |  76 kB     00:00    
(26/67): perl-Exporter-5.72-396.el8.noarch.rpm  1.9 MB/s |  34 kB     00:00    
(27/67): perl-Encode-2.97-3.el8.x86_64.rpm      8.5 MB/s | 1.5 MB     00:00    
(28/67): perl-File-Path-2.15-2.el8.noarch.rpm   2.2 MB/s |  38 kB     00:00    
(29/67): perl-Getopt-Long-2.50-4.el8.noarch.rpm 2.4 MB/s |  63 kB     00:00    
(30/67): perl-File-Temp-0.230.600-1.el8.noarch. 1.9 MB/s |  63 kB     00:00    
(31/67): perl-HTTP-Tiny-0.074-1.el8.noarch.rpm  3.8 MB/s |  58 kB     00:00    
(32/67): perl-IO-1.38-420.el8.x86_64.rpm        6.2 MB/s | 142 kB     00:00    
(33/67): perl-PathTools-3.74-1.el8.x86_64.rpm   3.6 MB/s |  90 kB     00:00    
(34/67): perl-MIME-Base64-3.15-396.el8.x86_64.r 808 kB/s |  31 kB     00:00    
(35/67): perl-Pod-Escapes-1.07-395.el8.noarch.r 1.4 MB/s |  20 kB     00:00    
(36/67): perl-Pod-Perldoc-3.28-396.el8.noarch.r 1.9 MB/s |  86 kB     00:00    
(37/67): perl-Pod-Simple-3.35-395.el8.noarch.rp 4.3 MB/s | 213 kB     00:00    
(38/67): perl-Pod-Usage-1.69-395.el8.noarch.rpm 1.1 MB/s |  34 kB     00:00    
(39/67): perl-Scalar-List-Utils-1.49-2.el8.x86_ 3.2 MB/s |  68 kB     00:00    
(40/67): perl-Socket-2.027-3.el8.x86_64.rpm     2.7 MB/s |  59 kB     00:00    
(41/67): perl-Storable-3.11-3.el8.x86_64.rpm    3.6 MB/s |  98 kB     00:00    
(42/67): python3-babel-2.5.1-7.el8.noarch.rpm   8.1 MB/s | 4.8 MB     00:00    
(43/67): perl-Term-ANSIColor-4.06-396.el8.noarc 1.1 MB/s |  46 kB     00:00    
(44/67): perl-Term-Cap-1.17-395.el8.noarch.rpm  455 kB/s |  23 kB     00:00    
(45/67): perl-Text-Tabs+Wrap-2013.0523-395.el8. 500 kB/s |  24 kB     00:00    
(46/67): perl-Time-Local-1.280-1.el8.noarch.rpm 944 kB/s |  34 kB     00:00    
(47/67): perl-Text-ParseWords-3.30-395.el8.noar 293 kB/s |  18 kB     00:00    
(48/67): perl-constant-1.33-396.el8.noarch.rpm  1.2 MB/s |  25 kB     00:00    
(49/67): perl-Unicode-Normalize-1.25-396.el8.x8 2.2 MB/s |  82 kB     00:00    
(50/67): perl-macros-5.26.3-420.el8.x86_64.rpm  3.1 MB/s |  72 kB     00:00    
(51/67): perl-parent-0.237-1.el8.noarch.rpm     645 kB/s |  20 kB     00:00    
(52/67): perl-podlators-4.11-1.el8.noarch.rpm   2.4 MB/s | 118 kB     00:00    
(53/67): perl-threads-2.21-2.el8.x86_64.rpm     2.4 MB/s |  61 kB     00:00    
(54/67): perl-threads-shared-1.58-2.el8.x86_64. 2.9 MB/s |  48 kB     00:00    
(55/67): perl-libs-5.26.3-420.el8.x86_64.rpm    9.4 MB/s | 1.6 MB     00:00    
(56/67): python3-pyyaml-3.12-12.el8.x86_64.rpm  4.4 MB/s | 193 kB     00:00    
(57/67): python3-setuptools-39.2.0-6.el8.noarch 2.4 MB/s | 163 kB     00:00    
(58/67): libsodium-1.0.18-2.el8.x86_64.rpm      6.4 MB/s | 162 kB     00:00    
(59/67): python3-bcrypt-3.1.6-2.el8.1.x86_64.rp 6.9 MB/s |  44 kB     00:00    
(60/67): python3-paramiko-2.4.3-1.el8.noarch.rp 7.0 MB/s | 289 kB     00:00    
(61/67): python3-pynacl-1.3.0-5.el8.x86_64.rpm  5.9 MB/s | 100 kB     00:00    
(62/67): sshpass-1.06-9.el8.x86_64.rpm          3.7 MB/s |  27 kB     00:00    
(63/67): chkconfig-1.19.1-1.el8.x86_64.rpm      6.6 MB/s | 198 kB     00:00    
(64/67): perl-interpreter-5.26.3-420.el8.x86_64  12 MB/s | 6.3 MB     00:00    
(65/67): platform-python-pip-9.0.3-20.el8.noarc 8.7 MB/s | 1.7 MB     00:00    
(66/67): platform-python-setuptools-39.2.0-6.el 6.4 MB/s | 632 kB     00:00    
(67/67): ansible-2.9.27-1.el8.noarch.rpm         14 MB/s |  17 MB     00:01    
--------------------------------------------------------------------------------
Total                                            12 MB/s |  47 MB     00:03     
warning: /var/cache/dnf/AppStream-a520ed22b0a8a736/packages/git-2.27.0-1.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY
CentOS-8 - AppStream                            1.6 MB/s | 1.6 kB     00:00    
Importing GPG key 0x8483C65D:
 Userid     : "CentOS (CentOS Official Signing Key) <security@centos.org>"
 Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D
 From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
Key imported successfully
warning: /var/cache/dnf/epel-6519ee669354a484/packages/ansible-2.9.27-1.el8.noarch.rpm: Header V4 RSA/SHA256 Signature, key ID 2f86d6a1: NOKEY
Extra Packages for Enterprise Linux 8 - x86_64  1.6 MB/s | 1.6 kB     00:00    
Importing GPG key 0x2F86D6A1:
 Userid     : "Fedora EPEL (8) <epel@fedoraproject.org>"
 Fingerprint: 94E2 79EB 8D8F 25B2 1810 ADF1 21EA 45AB 2F86 D6A1
 From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-8
Key imported successfully
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Upgrading        : platform-python-setuptools-39.2.0-6.el8.noarch        1/70 
  Installing       : python3-setuptools-39.2.0-6.el8.noarch                2/70 
  Installing       : git-core-2.27.0-1.el8.x86_64                          3/70 
  Installing       : git-core-doc-2.27.0-1.el8.noarch                      4/70 
  Upgrading        : platform-python-pip-9.0.3-20.el8.noarch               5/70 
  Installing       : perl-Digest-1.17-395.el8.noarch                       6/70 
  Installing       : perl-Digest-MD5-2.55-396.el8.x86_64                   7/70 
  Installing       : perl-Data-Dumper-2.167-399.el8.x86_64                 8/70 
  Installing       : perl-libnet-3.11-3.el8.noarch                         9/70 
  Installing       : perl-Net-SSLeay-1.88-1.module_el8.3.0+410+ff426aa3   10/70 
  Installing       : perl-URI-1.73-3.el8.noarch                           11/70 
  Installing       : perl-Pod-Escapes-1:1.07-395.el8.noarch               12/70 
  Installing       : perl-Mozilla-CA-20160104-7.module_el8.3.0+416+dee7   13/70 
  Installing       : perl-IO-Socket-IP-0.39-5.el8.noarch                  14/70 
  Installing       : perl-Time-Local-1:1.280-1.el8.noarch                 15/70 
  Installing       : perl-IO-Socket-SSL-2.066-4.module_el8.3.0+410+ff42   16/70 
  Installing       : perl-Term-ANSIColor-4.06-396.el8.noarch              17/70 
  Installing       : perl-Term-Cap-1.17-395.el8.noarch                    18/70 
  Installing       : perl-File-Temp-0.230.600-1.el8.noarch                19/70 
  Installing       : perl-Pod-Simple-1:3.35-395.el8.noarch                20/70 
  Installing       : perl-HTTP-Tiny-0.074-1.el8.noarch                    21/70 
  Installing       : perl-podlators-4.11-1.el8.noarch                     22/70 
  Installing       : perl-Pod-Perldoc-3.28-396.el8.noarch                 23/70 
  Installing       : perl-Text-ParseWords-3.30-395.el8.noarch             24/70 
  Installing       : perl-Pod-Usage-4:1.69-395.el8.noarch                 25/70 
  Installing       : perl-MIME-Base64-3.15-396.el8.x86_64                 26/70 
  Installing       : perl-Storable-1:3.11-3.el8.x86_64                    27/70 
  Installing       : perl-Getopt-Long-1:2.50-4.el8.noarch                 28/70 
  Installing       : perl-Errno-1.28-420.el8.x86_64                       29/70 
  Installing       : perl-Socket-4:2.027-3.el8.x86_64                     30/70 
  Installing       : perl-Encode-4:2.97-3.el8.x86_64                      31/70 
  Installing       : perl-Carp-1.42-396.el8.noarch                        32/70 
  Installing       : perl-Exporter-5.72-396.el8.noarch                    33/70 
  Installing       : perl-libs-4:5.26.3-420.el8.x86_64                    34/70 
  Installing       : perl-Scalar-List-Utils-3:1.49-2.el8.x86_64           35/70 
  Installing       : perl-parent-1:0.237-1.el8.noarch                     36/70 
  Installing       : perl-macros-4:5.26.3-420.el8.x86_64                  37/70 
  Installing       : perl-Text-Tabs+Wrap-2013.0523-395.el8.noarch         38/70 
  Installing       : perl-Unicode-Normalize-1.25-396.el8.x86_64           39/70 
  Installing       : perl-File-Path-2.15-2.el8.noarch                     40/70 
  Installing       : perl-IO-1.38-420.el8.x86_64                          41/70 
  Installing       : perl-PathTools-3.74-1.el8.x86_64                     42/70 
  Installing       : perl-constant-1.33-396.el8.noarch                    43/70 
  Installing       : perl-threads-1:2.21-2.el8.x86_64                     44/70 
  Installing       : perl-threads-shared-1.58-2.el8.x86_64                45/70 
  Installing       : perl-interpreter-4:5.26.3-420.el8.x86_64             46/70 
  Installing       : perl-Error-1:0.17025-2.el8.noarch                    47/70 
  Installing       : perl-TermReadKey-2.37-7.el8.x86_64                   48/70 
  Upgrading        : chkconfig-1.19.1-1.el8.x86_64                        49/70 
  Installing       : python36-3.6.8-38.module_el8.5.0+895+a459eca8.x86_   50/70 
  Running scriptlet: python36-3.6.8-38.module_el8.5.0+895+a459eca8.x86_   50/70 
  Installing       : python3-pip-9.0.3-20.el8.noarch                      51/70 
  Installing       : sshpass-1.06-9.el8.x86_64                            52/70 
  Installing       : python3-bcrypt-3.1.6-2.el8.1.x86_64                  53/70 
  Installing       : libsodium-1.0.18-2.el8.x86_64                        54/70 
  Installing       : python3-pynacl-1.3.0-5.el8.x86_64                    55/70 
  Installing       : python3-pyyaml-3.12-12.el8.x86_64                    56/70 
  Installing       : emacs-filesystem-1:26.1-7.el8.noarch                 57/70 
  Installing       : perl-Git-2.27.0-1.el8.noarch                         58/70 
  Installing       : git-2.27.0-1.el8.x86_64                              59/70 
  Installing       : python3-pytz-2017.2-9.el8.noarch                     60/70 
  Installing       : python3-babel-2.5.1-7.el8.noarch                     61/70 
  Installing       : python3-pyasn1-0.3.7-6.el8.noarch                    62/70 
  Installing       : python3-paramiko-2.4.3-1.el8.noarch                  63/70 
  Installing       : python3-markupsafe-0.23-19.el8.x86_64                64/70 
  Installing       : python3-jinja2-2.10.1-3.el8.noarch                   65/70 
  Installing       : python3-jmespath-0.9.0-11.el8.noarch                 66/70 
  Installing       : ansible-2.9.27-1.el8.noarch                          67/70 
  Cleanup          : platform-python-pip-9.0.3-13.el8.noarch              68/70 
  Cleanup          : platform-python-setuptools-39.2.0-4.el8.noarch       69/70 
  Cleanup          : chkconfig-1.11-1.el8.x86_64                          70/70 
  Running scriptlet: chkconfig-1.11-1.el8.x86_64                          70/70 
  Verifying        : git-2.27.0-1.el8.x86_64                               1/70 
  Verifying        : git-core-2.27.0-1.el8.x86_64                          2/70 
  Verifying        : git-core-doc-2.27.0-1.el8.noarch                      3/70 
  Verifying        : perl-Digest-1.17-395.el8.noarch                       4/70 
  Verifying        : perl-Digest-MD5-2.55-396.el8.x86_64                   5/70 
  Verifying        : perl-Error-1:0.17025-2.el8.noarch                     6/70 
  Verifying        : perl-Git-2.27.0-1.el8.noarch                          7/70 
  Verifying        : perl-IO-Socket-IP-0.39-5.el8.noarch                   8/70 
  Verifying        : perl-IO-Socket-SSL-2.066-4.module_el8.3.0+410+ff42    9/70 
  Verifying        : perl-Mozilla-CA-20160104-7.module_el8.3.0+416+dee7   10/70 
  Verifying        : perl-Net-SSLeay-1.88-1.module_el8.3.0+410+ff426aa3   11/70 
  Verifying        : perl-TermReadKey-2.37-7.el8.x86_64                   12/70 
  Verifying        : perl-URI-1.73-3.el8.noarch                           13/70 
  Verifying        : perl-libnet-3.11-3.el8.noarch                        14/70 
  Verifying        : python3-babel-2.5.1-7.el8.noarch                     15/70 
  Verifying        : python3-jinja2-2.10.1-3.el8.noarch                   16/70 
  Verifying        : python3-jmespath-0.9.0-11.el8.noarch                 17/70 
  Verifying        : python3-markupsafe-0.23-19.el8.x86_64                18/70 
  Verifying        : python3-pip-9.0.3-20.el8.noarch                      19/70 
  Verifying        : python3-pyasn1-0.3.7-6.el8.noarch                    20/70 
  Verifying        : python3-pytz-2017.2-9.el8.noarch                     21/70 
  Verifying        : python36-3.6.8-38.module_el8.5.0+895+a459eca8.x86_   22/70 
  Verifying        : emacs-filesystem-1:26.1-7.el8.noarch                 23/70 
  Verifying        : perl-Carp-1.42-396.el8.noarch                        24/70 
  Verifying        : perl-Data-Dumper-2.167-399.el8.x86_64                25/70 
  Verifying        : perl-Encode-4:2.97-3.el8.x86_64                      26/70 
  Verifying        : perl-Errno-1.28-420.el8.x86_64                       27/70 
  Verifying        : perl-Exporter-5.72-396.el8.noarch                    28/70 
  Verifying        : perl-File-Path-2.15-2.el8.noarch                     29/70 
  Verifying        : perl-File-Temp-0.230.600-1.el8.noarch                30/70 
  Verifying        : perl-Getopt-Long-1:2.50-4.el8.noarch                 31/70 
  Verifying        : perl-HTTP-Tiny-0.074-1.el8.noarch                    32/70 
  Verifying        : perl-IO-1.38-420.el8.x86_64                          33/70 
  Verifying        : perl-MIME-Base64-3.15-396.el8.x86_64                 34/70 
  Verifying        : perl-PathTools-3.74-1.el8.x86_64                     35/70 
  Verifying        : perl-Pod-Escapes-1:1.07-395.el8.noarch               36/70 
  Verifying        : perl-Pod-Perldoc-3.28-396.el8.noarch                 37/70 
  Verifying        : perl-Pod-Simple-1:3.35-395.el8.noarch                38/70 
  Verifying        : perl-Pod-Usage-4:1.69-395.el8.noarch                 39/70 
  Verifying        : perl-Scalar-List-Utils-3:1.49-2.el8.x86_64           40/70 
  Verifying        : perl-Socket-4:2.027-3.el8.x86_64                     41/70 
  Verifying        : perl-Storable-1:3.11-3.el8.x86_64                    42/70 
  Verifying        : perl-Term-ANSIColor-4.06-396.el8.noarch              43/70 
  Verifying        : perl-Term-Cap-1.17-395.el8.noarch                    44/70 
  Verifying        : perl-Text-ParseWords-3.30-395.el8.noarch             45/70 
  Verifying        : perl-Text-Tabs+Wrap-2013.0523-395.el8.noarch         46/70 
  Verifying        : perl-Time-Local-1:1.280-1.el8.noarch                 47/70 
  Verifying        : perl-Unicode-Normalize-1.25-396.el8.x86_64           48/70 
  Verifying        : perl-constant-1.33-396.el8.noarch                    49/70 
  Verifying        : perl-interpreter-4:5.26.3-420.el8.x86_64             50/70 
  Verifying        : perl-libs-4:5.26.3-420.el8.x86_64                    51/70 
  Verifying        : perl-macros-4:5.26.3-420.el8.x86_64                  52/70 
  Verifying        : perl-parent-1:0.237-1.el8.noarch                     53/70 
  Verifying        : perl-podlators-4.11-1.el8.noarch                     54/70 
  Verifying        : perl-threads-1:2.21-2.el8.x86_64                     55/70 
  Verifying        : perl-threads-shared-1.58-2.el8.x86_64                56/70 
  Verifying        : python3-pyyaml-3.12-12.el8.x86_64                    57/70 
  Verifying        : python3-setuptools-39.2.0-6.el8.noarch               58/70 
  Verifying        : ansible-2.9.27-1.el8.noarch                          59/70 
  Verifying        : libsodium-1.0.18-2.el8.x86_64                        60/70 
  Verifying        : python3-bcrypt-3.1.6-2.el8.1.x86_64                  61/70 
  Verifying        : python3-paramiko-2.4.3-1.el8.noarch                  62/70 
  Verifying        : python3-pynacl-1.3.0-5.el8.x86_64                    63/70 
  Verifying        : sshpass-1.06-9.el8.x86_64                            64/70 
  Verifying        : chkconfig-1.19.1-1.el8.x86_64                        65/70 
  Verifying        : chkconfig-1.11-1.el8.x86_64                          66/70 
  Verifying        : platform-python-pip-9.0.3-20.el8.noarch              67/70 
  Verifying        : platform-python-pip-9.0.3-13.el8.noarch              68/70 
  Verifying        : platform-python-setuptools-39.2.0-6.el8.noarch       69/70 
  Verifying        : platform-python-setuptools-39.2.0-4.el8.noarch       70/70 

Upgraded:
  chkconfig-1.19.1-1.el8.x86_64                                                 
  platform-python-pip-9.0.3-20.el8.noarch                                       
  platform-python-setuptools-39.2.0-6.el8.noarch                                

Installed:
  git-2.27.0-1.el8.x86_64                                                       
  ansible-2.9.27-1.el8.noarch                                                   
  perl-IO-Socket-IP-0.39-5.el8.noarch                                           
  perl-IO-Socket-SSL-2.066-4.module_el8.3.0+410+ff426aa3.noarch                 
  perl-Mozilla-CA-20160104-7.module_el8.3.0+416+dee7bcef.noarch                 
  python3-paramiko-2.4.3-1.el8.noarch                                           
  git-core-2.27.0-1.el8.x86_64                                                  
  git-core-doc-2.27.0-1.el8.noarch                                              
  perl-Digest-1.17-395.el8.noarch                                               
  perl-Digest-MD5-2.55-396.el8.x86_64                                           
  perl-Error-1:0.17025-2.el8.noarch                                             
  perl-Git-2.27.0-1.el8.noarch                                                  
  perl-Net-SSLeay-1.88-1.module_el8.3.0+410+ff426aa3.x86_64                     
  perl-TermReadKey-2.37-7.el8.x86_64                                            
  perl-URI-1.73-3.el8.noarch                                                    
  perl-libnet-3.11-3.el8.noarch                                                 
  python3-babel-2.5.1-7.el8.noarch                                              
  python3-jinja2-2.10.1-3.el8.noarch                                            
  python3-jmespath-0.9.0-11.el8.noarch                                          
  python3-markupsafe-0.23-19.el8.x86_64                                         
  python3-pip-9.0.3-20.el8.noarch                                               
  python3-pyasn1-0.3.7-6.el8.noarch                                             
  python3-pytz-2017.2-9.el8.noarch                                              
  python36-3.6.8-38.module_el8.5.0+895+a459eca8.x86_64                          
  emacs-filesystem-1:26.1-7.el8.noarch                                          
  perl-Carp-1.42-396.el8.noarch                                                 
  perl-Data-Dumper-2.167-399.el8.x86_64                                         
  perl-Encode-4:2.97-3.el8.x86_64                                               
  perl-Errno-1.28-420.el8.x86_64                                                
  perl-Exporter-5.72-396.el8.noarch                                             
  perl-File-Path-2.15-2.el8.noarch                                              
  perl-File-Temp-0.230.600-1.el8.noarch                                         
  perl-Getopt-Long-1:2.50-4.el8.noarch                                          
  perl-HTTP-Tiny-0.074-1.el8.noarch                                             
  perl-IO-1.38-420.el8.x86_64                                                   
  perl-MIME-Base64-3.15-396.el8.x86_64                                          
  perl-PathTools-3.74-1.el8.x86_64                                              
  perl-Pod-Escapes-1:1.07-395.el8.noarch                                        
  perl-Pod-Perldoc-3.28-396.el8.noarch                                          
  perl-Pod-Simple-1:3.35-395.el8.noarch                                         
  perl-Pod-Usage-4:1.69-395.el8.noarch                                          
  perl-Scalar-List-Utils-3:1.49-2.el8.x86_64                                    
  perl-Socket-4:2.027-3.el8.x86_64                                              
  perl-Storable-1:3.11-3.el8.x86_64                                             
  perl-Term-ANSIColor-4.06-396.el8.noarch                                       
  perl-Term-Cap-1.17-395.el8.noarch                                             
  perl-Text-ParseWords-3.30-395.el8.noarch                                      
  perl-Text-Tabs+Wrap-2013.0523-395.el8.noarch                                  
  perl-Time-Local-1:1.280-1.el8.noarch                                          
  perl-Unicode-Normalize-1.25-396.el8.x86_64                                    
  perl-constant-1.33-396.el8.noarch                                             
  perl-interpreter-4:5.26.3-420.el8.x86_64                                      
  perl-libs-4:5.26.3-420.el8.x86_64                                             
  perl-macros-4:5.26.3-420.el8.x86_64                                           
  perl-parent-1:0.237-1.el8.noarch                                              
  perl-podlators-4.11-1.el8.noarch                                              
  perl-threads-1:2.21-2.el8.x86_64                                              
  perl-threads-shared-1.58-2.el8.x86_64                                         
  python3-pyyaml-3.12-12.el8.x86_64                                             
  python3-setuptools-39.2.0-6.el8.noarch                                        
  libsodium-1.0.18-2.el8.x86_64                                                 
  python3-bcrypt-3.1.6-2.el8.1.x86_64                                           
  python3-pynacl-1.3.0-5.el8.x86_64                                             
  sshpass-1.06-9.el8.x86_64                                                     

Complete!
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 git clone https://github.com/RedHatOfficial/ocp4-helpernode
Cloning into 'ocp4-helpernode'...
#ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 git clone -b image_url https://github.com/kanekoh/ocp4-helpernode
scp -o "StrictHostKeyChecking=no" ./files/bashrc root@192.168.7.77:/tmp/bashrc
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 "cat /tmp/bashrc >> ~/.bashrc"
./scripts/generate_vars.sh /home/cloud-user/openshift-env-helper/ocp4-workingdir 4.9
scp -o "StrictHostKeyChecking=no" /home/cloud-user/openshift-env-helper/ocp4-workingdir/vars.yaml root@192.168.7.77:~/ocp4-helpernode/
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 "cd ocp4-helpernode; ansible-playbook -e @vars.yaml tasks/main.yml"

PLAY [all] *********************************************************************

TASK [Gathering Facts] *********************************************************
ok: [localhost]

TASK [Validate values for DNS compatibility] ***********************************
[WARNING]: conditional statements should not include jinja2 templating
delimiters such as {{ }} or {% %}. Found: item is search('{{ chars }}')
skipping: [localhost] => (item=example.com) 
skipping: [localhost] => (item=helper) 
skipping: [localhost] => (item=bootstrap) 
skipping: [localhost] => (item={'name': 'master0', 'ipaddr': '192.168.7.21', 'macaddr': '52:54:00:be:60:53'}) 
skipping: [localhost] => (item={'name': 'master1', 'ipaddr': '192.168.7.22', 'macaddr': '52:54:00:a4:da:49'}) 
skipping: [localhost] => (item={'name': 'master2', 'ipaddr': '192.168.7.23', 'macaddr': '52:54:00:6d:64:85'}) 
skipping: [localhost] => (item={'name': 'worker0', 'ipaddr': '192.168.7.11', 'macaddr': '52:54:00:cb:5f:9b'}) 
skipping: [localhost] => (item={'name': 'worker1', 'ipaddr': '192.168.7.12', 'macaddr': '52:54:00:09:5a:4c'}) 
skipping: [localhost] => (item={'name': 'odf0', 'ipaddr': '192.168.7.31', 'macaddr': '52:54:00:fe:e3:9a'}) 
skipping: [localhost] => (item={'name': 'odf1', 'ipaddr': '192.168.7.32', 'macaddr': '52:54:00:dd:2e:63'}) 
skipping: [localhost] => (item={'name': 'odf2', 'ipaddr': '192.168.7.33', 'macaddr': '52:54:00:95:d8:75'}) 

TASK [file] ********************************************************************
ok: [localhost]

TASK [openssh_keypair] *********************************************************
changed: [localhost]

TASK [blockinfile] *************************************************************
changed: [localhost] => (item={'name': 'master0', 'ipaddr': '192.168.7.21', 'macaddr': '52:54:00:be:60:53'})
changed: [localhost] => (item={'name': 'master1', 'ipaddr': '192.168.7.22', 'macaddr': '52:54:00:a4:da:49'})
changed: [localhost] => (item={'name': 'master2', 'ipaddr': '192.168.7.23', 'macaddr': '52:54:00:6d:64:85'})

TASK [blockinfile] *************************************************************
changed: [localhost] => (item={'name': 'worker0', 'ipaddr': '192.168.7.11', 'macaddr': '52:54:00:cb:5f:9b'})
changed: [localhost] => (item={'name': 'worker1', 'ipaddr': '192.168.7.12', 'macaddr': '52:54:00:09:5a:4c'})
changed: [localhost] => (item={'name': 'odf0', 'ipaddr': '192.168.7.31', 'macaddr': '52:54:00:fe:e3:9a'})
changed: [localhost] => (item={'name': 'odf1', 'ipaddr': '192.168.7.32', 'macaddr': '52:54:00:dd:2e:63'})
changed: [localhost] => (item={'name': 'odf2', 'ipaddr': '192.168.7.33', 'macaddr': '52:54:00:95:d8:75'})

TASK [blockinfile] *************************************************************
changed: [localhost] => (item={'name': 'bootstrap'})

TASK [assert] ******************************************************************
fatal: [localhost]: FAILED! => {
    "assertion": false,
    "changed": false,
    "evaluated_to": false,
    "msg": "Assertion failed"
}

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [set_fact] ****************************************************************
ok: [localhost]

TASK [Install needed packages] *************************************************
changed: [localhost]

TASK [Install packages for DHCP/PXE install] ***********************************
changed: [localhost]

TASK [Install additional package for Intel platforms] **************************
changed: [localhost]

TASK [Remove existing dhcp config] *********************************************
skipping: [localhost]

TASK [Remove existing named config] ********************************************
skipping: [localhost]

TASK [Remove existing DNS zone files] ******************************************
skipping: [localhost] => (item=zonefile.db) 
skipping: [localhost] => (item=reverse.db) 

TASK [Remove existing haproxy config] ******************************************
skipping: [localhost]

TASK [Remove existing TFTP config] *********************************************
skipping: [localhost]

TASK [Remove existing grub.cfg] ************************************************
skipping: [localhost]

TASK [Write out dhcp file] *****************************************************
changed: [localhost]

TASK [Write out dhcp file (UEFI)] **********************************************
skipping: [localhost]

TASK [Write out named file] ****************************************************
changed: [localhost]

TASK [Installing DNS Serialnumber generator] ***********************************
changed: [localhost]

TASK [Set zone serial number] **************************************************
changed: [localhost]

TASK [Setting serial number as a fact] *****************************************
ok: [localhost]

TASK [Write out "example.com" zone file] ***************************************
changed: [localhost]

TASK [Write out reverse zone file] *********************************************
changed: [localhost]

TASK [Write out haproxy config file] *******************************************
changed: [localhost]

TASK [Copy httpd conf file] ****************************************************
changed: [localhost]

TASK [Create apache directories for installing] ********************************
changed: [localhost] => (item=/var/www/html/install)
changed: [localhost] => (item=/var/www/html/ignition)

TASK [Delete OCP4 files, if requested, to download again] **********************
skipping: [localhost] => (item=/usr/local/src/openshift-client-linux.tar.gz) 
skipping: [localhost] => (item=/usr/local/src/openshift-install-linux.tar.gz) 
skipping: [localhost] => (item=/var/www/html/install/bios.raw.gz) 
skipping: [localhost] => (item=/var/www/html/install/rootfs.img) 
skipping: [localhost] => (item=/var/lib/tftpboot/rhcos/initramfs.img) 
skipping: [localhost] => (item=/var/lib/tftpboot/rhcos/kernel) 

TASK [Downloading OCP4 installer Bios] *****************************************
skipping: [localhost]

TASK [Downloading OCP4 installer rootfs] ***************************************
changed: [localhost]

TASK [Start firewalld service] *************************************************
ok: [localhost]

TASK [Open up firewall ports] **************************************************
changed: [localhost -> localhost] => (item=['67/udp', 'localhost'])
changed: [localhost -> localhost] => (item=['53/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['53/udp', 'localhost'])
changed: [localhost -> localhost] => (item=['443/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['80/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['8080/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['6443/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['6443/udp', 'localhost'])
changed: [localhost -> localhost] => (item=['22623/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['22623/udp', 'localhost'])
changed: [localhost -> localhost] => (item=['9000/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['69/udp', 'localhost'])
changed: [localhost -> localhost] => (item=['111/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['2049/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['20048/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['50825/tcp', 'localhost'])
changed: [localhost -> localhost] => (item=['53248/tcp', 'localhost'])

TASK [Best effort SELinux repair - DNS] ****************************************
changed: [localhost]

TASK [Best effort SELinux repair - Apache] *************************************
changed: [localhost]

TASK [Create NFS export directory] *********************************************
changed: [localhost]

TASK [Copy NFS export conf file] ***********************************************
changed: [localhost]

TASK [Create TFTP config] ******************************************************
changed: [localhost]

TASK [generate netboot entry for grub2] ****************************************
skipping: [localhost]

TASK [Create TFTP RHCOS dir] ***************************************************
changed: [localhost]

TASK [SEBool allow haproxy connect any port] ***********************************
changed: [localhost]

TASK [Copy over files needed for TFTP] *****************************************
changed: [localhost]

TASK [Downloading OCP4 installer initramfs] ************************************
changed: [localhost]

TASK [Downloading OCP4 installer kernel] ***************************************
changed: [localhost]

TASK [Set the default tftp file] ***********************************************
[WARNING]: conditional statements should not include jinja2 templating
delimiters such as {{ }} or {% %}. Found: {{ pxe.generate_default |
default(false) }}
skipping: [localhost]

TASK [Set the bootstrap specific tftp file] ************************************
changed: [localhost]

TASK [Set the master specific tftp files] **************************************
changed: [localhost] => (item={'name': 'master0', 'ipaddr': '192.168.7.21', 'macaddr': '52:54:00:be:60:53'})
changed: [localhost] => (item={'name': 'master1', 'ipaddr': '192.168.7.22', 'macaddr': '52:54:00:a4:da:49'})
changed: [localhost] => (item={'name': 'master2', 'ipaddr': '192.168.7.23', 'macaddr': '52:54:00:6d:64:85'})

TASK [Set the worker specific tftp files] **************************************
changed: [localhost] => (item={'name': 'worker0', 'ipaddr': '192.168.7.11', 'macaddr': '52:54:00:cb:5f:9b'})
changed: [localhost] => (item={'name': 'worker1', 'ipaddr': '192.168.7.12', 'macaddr': '52:54:00:09:5a:4c'})
changed: [localhost] => (item={'name': 'odf0', 'ipaddr': '192.168.7.31', 'macaddr': '52:54:00:fe:e3:9a'})
changed: [localhost] => (item={'name': 'odf1', 'ipaddr': '192.168.7.32', 'macaddr': '52:54:00:dd:2e:63'})
changed: [localhost] => (item={'name': 'odf2', 'ipaddr': '192.168.7.33', 'macaddr': '52:54:00:95:d8:75'})

TASK [Install packages for UEFI install] ***************************************
skipping: [localhost]

TASK [Create tftp grub2 directory] *********************************************
skipping: [localhost]

TASK [copy UEFI shim to grub2 tftpboot/grub2 directory] ************************
skipping: [localhost]

TASK [copy grub2 EFI file to tftpboot/grub2 directory] *************************
skipping: [localhost]

TASK [Create the bootstrap specific grub2 file] ********************************
skipping: [localhost]

TASK [Set the master specific tftp files] **************************************
skipping: [localhost] => (item={'name': 'master0', 'ipaddr': '192.168.7.21', 'macaddr': '52:54:00:be:60:53'}) 
skipping: [localhost] => (item={'name': 'master1', 'ipaddr': '192.168.7.22', 'macaddr': '52:54:00:a4:da:49'}) 
skipping: [localhost] => (item={'name': 'master2', 'ipaddr': '192.168.7.23', 'macaddr': '52:54:00:6d:64:85'}) 

TASK [Set the worker specific tftp files] **************************************
skipping: [localhost] => (item={'name': 'worker0', 'ipaddr': '192.168.7.11', 'macaddr': '52:54:00:cb:5f:9b'}) 
skipping: [localhost] => (item={'name': 'worker1', 'ipaddr': '192.168.7.12', 'macaddr': '52:54:00:09:5a:4c'}) 
skipping: [localhost] => (item={'name': 'odf0', 'ipaddr': '192.168.7.31', 'macaddr': '52:54:00:fe:e3:9a'}) 
skipping: [localhost] => (item={'name': 'odf1', 'ipaddr': '192.168.7.32', 'macaddr': '52:54:00:dd:2e:63'}) 
skipping: [localhost] => (item={'name': 'odf2', 'ipaddr': '192.168.7.33', 'macaddr': '52:54:00:95:d8:75'}) 

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [set_fact] ****************************************************************
skipping: [localhost]

TASK [create grub.cfg] *********************************************************
skipping: [localhost]

TASK [generate grub entry (bootstrap)] *****************************************
skipping: [localhost]

TASK [generate grub entry (masters)] *******************************************
skipping: [localhost] => (item={'name': 'master0', 'ipaddr': '192.168.7.21', 'macaddr': '52:54:00:be:60:53'}) 
skipping: [localhost] => (item={'name': 'master1', 'ipaddr': '192.168.7.22', 'macaddr': '52:54:00:a4:da:49'}) 
skipping: [localhost] => (item={'name': 'master2', 'ipaddr': '192.168.7.23', 'macaddr': '52:54:00:6d:64:85'}) 

TASK [generate grub entry (workers)] *******************************************
skipping: [localhost] => (item={'name': 'worker0', 'ipaddr': '192.168.7.11', 'macaddr': '52:54:00:cb:5f:9b'}) 
skipping: [localhost] => (item={'name': 'worker1', 'ipaddr': '192.168.7.12', 'macaddr': '52:54:00:09:5a:4c'}) 
skipping: [localhost] => (item={'name': 'odf0', 'ipaddr': '192.168.7.31', 'macaddr': '52:54:00:fe:e3:9a'}) 
skipping: [localhost] => (item={'name': 'odf1', 'ipaddr': '192.168.7.32', 'macaddr': '52:54:00:dd:2e:63'}) 
skipping: [localhost] => (item={'name': 'odf2', 'ipaddr': '192.168.7.33', 'macaddr': '52:54:00:95:d8:75'}) 

TASK [Installing TFTP Systemd helper] ******************************************
changed: [localhost]

TASK [Installing TFTP Systemd unit file] ***************************************
changed: [localhost]

TASK [Systemd daemon reload] ***************************************************
ok: [localhost]

TASK [Starting services] *******************************************************
changed: [localhost] => (item=named)
changed: [localhost] => (item=haproxy)
changed: [localhost] => (item=httpd)
changed: [localhost] => (item=rpcbind)
changed: [localhost] => (item=nfs-server)

TASK [Starting DHCP/PXE services] **********************************************
changed: [localhost] => (item=dhcpd)
changed: [localhost] => (item=tftp)
changed: [localhost] => (item=helper-tftp)

TASK [Unmasking Services] ******************************************************
ok: [localhost] => (item=tftp)

TASK [Copy info script over] ***************************************************
changed: [localhost]

TASK [Copying over nfs-provisioner rbac] ***************************************
changed: [localhost]

TASK [Copying over nfs-provisioner deployment] *********************************
changed: [localhost]

TASK [Copying over nfs-provisioner storageclass] *******************************
changed: [localhost]

TASK [Copying over nfs-provisioner setup script] *******************************
changed: [localhost]

TASK [Copying over a sample PVC file for NFS] **********************************
changed: [localhost]

TASK [Create folder for additional machineconfig] ******************************
skipping: [localhost]

TASK [Create temporary chrony.conf file] ***************************************
skipping: [localhost]

TASK [slurp contents of temporary chrony.conf file] ****************************
skipping: [localhost]

TASK [Generate Chrony machineconfig] *******************************************
skipping: [localhost] => (item=master) 

TASK [Generate Chrony machineconfig] *******************************************
skipping: [localhost] => (item=worker) 

TASK [Downloading OCP4 client] *************************************************
changed: [localhost]

TASK [Downloading OCP4 Installer] **********************************************
changed: [localhost]

TASK [Unarchiving OCP4 client] *************************************************
changed: [localhost]

TASK [Unarchiving OCP4 Installer] **********************************************
changed: [localhost]

TASK [Removing files that are not needed] **************************************
changed: [localhost]

TASK [Create helm source directory] ********************************************
changed: [localhost] => (item=/usr/local/src/helm)

TASK [Downloading helm source binary tarball] **********************************
changed: [localhost]

TASK [Unarchiving helm tarball] ************************************************
changed: [localhost]

TASK [Copy helm cli to bin directory for amd64] ********************************
changed: [localhost]

TASK [Copy helm cli to bin directory for ppc64le] ******************************
skipping: [localhost]

TASK [Downloading filetranspiler source] ***************************************
skipping: [localhost]

TASK [Building filetranspiler] *************************************************
skipping: [localhost]

TASK [Installing filetranspiler] ***********************************************
skipping: [localhost]

TASK [Set the local resolv.conf file] ******************************************
changed: [localhost]

TASK [Get network device system name] ******************************************
changed: [localhost]

TASK [Setting network device system name as a fact] ****************************
ok: [localhost]

TASK [Setting DNS server ip on network interface "enp1s0" to 127.0.0.1] ********
changed: [localhost]

TASK [Setting DNS search path on network interface "enp1s0" to "ocp4.example.com"] ***
changed: [localhost]

TASK [Restarting NetworkManager] ***********************************************
changed: [localhost] => (item=NetworkManager)

TASK [Install keepalived packages] *********************************************
skipping: [localhost]

TASK [Generate a random external password for Keepalived’s AUTH_PASS] **********
skipping: [localhost]

TASK [Set high_priority fact] **************************************************
skipping: [localhost]

TASK [Set low_priority fact] ***************************************************
skipping: [localhost]

TASK [Set calibrated_priority fact] ********************************************
skipping: [localhost]

TASK [Generate keepalived configuration file] **********************************
skipping: [localhost]

TASK [firewalld] ***************************************************************
skipping: [localhost]

TASK [Reload service firewalld] ************************************************
skipping: [localhost]

TASK [Enable and start service keepalived] *************************************
skipping: [localhost]

TASK [Install registry packages] ***********************************************
skipping: [localhost]

TASK [Create registry directories] *********************************************
skipping: [localhost] => (item=auth) 
skipping: [localhost] => (item=certs) 
skipping: [localhost] => (item=data) 

TASK [Generate an OpenSSL private key with the default values (4096 bits, RSA)] ***
skipping: [localhost]

TASK [Generate an OpenSSL Certificate Signing Request] *************************
skipping: [localhost]

TASK [Generate a Self Signed OpenSSL certificate] ******************************
skipping: [localhost]

TASK [Create the user and password for local registry] *************************
skipping: [localhost]

TASK [Synchronize directories across all hosts] ********************************
skipping: [localhost] => (item=/opt/registry/) 
skipping: [localhost] => (item=~/.openshift/) 

TASK [Copy Self Signed OpenSSL certificate] ************************************
skipping: [localhost]

TASK [Add the Self Signed OpenSSL certificate to your list of trusted certificates] ***
skipping: [localhost]

TASK [Generate local-registry service file] ************************************
skipping: [localhost]

TASK [Start local-registry] ****************************************************
skipping: [localhost]

TASK [Ensure registry pod is up] ***********************************************
skipping: [localhost]

TASK [Allow traffic at local registry port] ************************************
skipping: [localhost] => (item=internal) 
skipping: [localhost] => (item=public) 

TASK [Restarting regitry services] *********************************************
skipping: [localhost] => (item=named) 
skipping: [localhost] => (item=firewalld) 
skipping: [localhost] => (item=local-registry) 

TASK [Get local registry pod] **************************************************
skipping: [localhost]

TASK [Generate the base64-encoded user name and password or token for your mirror registry] ***
skipping: [localhost]

TASK [Mirror the registry] *****************************************************
skipping: [localhost]

TASK [Generate Local Registry information] *************************************
skipping: [localhost]

TASK [Process Local Registry information] **************************************
skipping: [localhost]

TASK [Mirror NFS image (x86_64)] ***********************************************
skipping: [localhost]

TASK [Mirror NFS image (ppc64le)] **********************************************
skipping: [localhost]

TASK [Enable restart always for critical services] *****************************
included: /root/ocp4-helpernode/tasks/restart_config.yaml for localhost
included: /root/ocp4-helpernode/tasks/restart_config.yaml for localhost
included: /root/ocp4-helpernode/tasks/restart_config.yaml for localhost
included: /root/ocp4-helpernode/tasks/restart_config.yaml for localhost

TASK [Create dropin directory for services] ************************************
changed: [localhost]

TASK [Copy restart conf file to the services dropin directory] *****************
changed: [localhost]

TASK [restart services] ********************************************************
changed: [localhost]

TASK [Create dropin directory for services] ************************************
changed: [localhost]

TASK [Copy restart conf file to the services dropin directory] *****************
changed: [localhost]

TASK [restart services] ********************************************************
changed: [localhost]

TASK [Create dropin directory for services] ************************************
changed: [localhost]

TASK [Copy restart conf file to the services dropin directory] *****************
changed: [localhost]

TASK [restart services] ********************************************************
changed: [localhost]

TASK [Create dropin directory for services] ************************************
changed: [localhost]

TASK [Copy restart conf file to the services dropin directory] *****************
changed: [localhost]

TASK [restart services] ********************************************************
changed: [localhost]

TASK [Disable named service] ***************************************************
skipping: [localhost]

TASK [Disable haproxy service] *************************************************
skipping: [localhost]

TASK [Information about this install] ******************************************
ok: [localhost] => {
    "msg": [
        "Please run /usr/local/bin/helpernodecheck for information"
    ]
}

RUNNING HANDLER [restart bind] *************************************************
changed: [localhost]

RUNNING HANDLER [restart haproxy] **********************************************
changed: [localhost]

RUNNING HANDLER [restart httpd] ************************************************
changed: [localhost]

RUNNING HANDLER [restart dhcpd] ************************************************
changed: [localhost]

RUNNING HANDLER [restart tftp] *************************************************
changed: [localhost]

RUNNING HANDLER [restart nfs] **************************************************
changed: [localhost]

PLAY RECAP *********************************************************************
localhost                  : ok=97   changed=73   unreachable=0    failed=0    skipped=73   rescued=1    ignored=0   

ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 mkdir -p ~/.openshift
scp -o "StrictHostKeyChecking=no" ./pull-secret root@192.168.7.77:~/.openshift/pull-secret
scp -o "StrictHostKeyChecking=no" ./scripts/install.sh root@192.168.7.77:~/
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 chmod +x install.sh
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 "NETWORK_CIDR=192.168.7  ./install.sh"
+ mkdir /root/ocp4
+ cd /root/ocp4
+ cat
+ openshift-install create manifests
level=info msg=Consuming Install Config from target directory
level=warning msg=Making control-plane schedulable by setting MastersSchedulable to true for Scheduler cluster settings
level=info msg=Manifests created in: manifests and openshift
+ sed -i 's/mastersSchedulable: true/mastersSchedulable: false/g' manifests/cluster-scheduler-02-config.yml
+ openshift-install create ignition-configs
level=info msg=Consuming Master Machines from target directory
level=info msg=Consuming OpenShift Install (Manifests) from target directory
level=info msg=Consuming Openshift Manifests from target directory
level=info msg=Consuming Worker Machines from target directory
level=info msg=Consuming Common Manifests from target directory
level=info msg=Ignition-Configs created in: . and auth
+ cp /root/ocp4/bootstrap.ign /root/ocp4/master.ign /root/ocp4/worker.ign /var/www/html/ignition/
+ restorecon -vR /var/www/html/
+ chmod o+r /var/www/html/ignition/bootstrap.ign /var/www/html/ignition/master.ign /var/www/html/ignition/worker.ign
./scripts/start_vms.sh 2
Domain ocp4-bootstrap started

Domain ocp4-master0 started

Domain ocp4-master1 started

Domain ocp4-master2 started

Domain ocp4-worker0 started

Domain ocp4-worker1 started

Domain ocp4-odf0 started

Domain ocp4-odf1 started

Domain ocp4-odf2 started

ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 openshift-install wait-for bootstrap-complete --log-level debug --dir ./ocp4
level=debug msg=OpenShift Installer 4.9.9
level=debug msg=Built from commit 1c538b8949f3a0e5b993e1ae33b9cd799806fa93
level=info msg=Waiting up to 20m0s for the Kubernetes API at https://api.ocp4.example.com:6443...
level=debug msg=Still waiting for the Kubernetes API: an error on the server ("") has prevented the request from succeeding
level=debug msg=Still waiting for the Kubernetes API: an error on the server ("") has prevented the request from succeeding
level=info msg=API v1.22.3+4dd1b5a up
level=info msg=Waiting up to 30m0s for bootstrapping to complete...
level=debug msg=Bootstrap status: complete
level=info msg=It is now safe to remove the bootstrap resources
level=debug msg=Time elapsed per stage:
level=debug msg=Bootstrap Complete: 12m11s
level=debug msg=               API: 4m6s
level=info msg=Time elapsed: 12m11s
virsh shutdown ocp4-bootstrap
Domain ocp4-bootstrap is being shutdown

ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 "echo export KUBECONFIG=/root/ocp4/auth/kubeconfig >> .bashrc"
scp -o "StrictHostKeyChecking=no" ./scripts/approve_csrs.sh root@192.168.7.77:~/
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 chmod +x approve_csrs.sh
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 "DEBUG=false INSTALL_ODF=true ./approve_csrs.sh 2 3"
......................................./approve_csrs.sh: line 18: 1200: No such file or directory
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 openshift-install wait-for install-complete --dir ./ocp4
level=info msg=Waiting up to 40m0s for the cluster at https://api.ocp4.example.com:6443 to initialize...
level=info msg=Waiting up to 10m0s for the openshift-console route to be created...
level=info msg=Install complete!
level=info msg=To access the cluster as the system:admin user when using 'oc', run 'export KUBECONFIG=/root/ocp4/auth/kubeconfig'
level=info msg=Access the OpenShift web-console here: https://console-openshift-console.apps.ocp4.example.com
level=info msg=Login to the console with user: "kubeadmin", and password: "rGI24-e6d25-HQLZH-gGK4F"
level=info msg=Time elapsed: 7m36s
scp -o "StrictHostKeyChecking=no" ./scripts/install_lso.sh root@192.168.7.77:~/
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 chmod +x install_lso.sh
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 "DEBUG=false INSTALL_ODF=true ./install_lso.sh"
Create New Project for local storage
Created project openshift-local-storage
project.project.openshift.io/openshift-local-storage annotated
node/odf0.ocp4.example.com labeled
node/odf1.ocp4.example.com labeled
node/odf2.ocp4.example.com labeled
Install Operator
operatorgroup.operators.coreos.com/local-operator-group created
subscription.operators.coreos.com/local-storage-operator created
Wait for install succeeded.
No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.No resources found in openshift-local-storage namespace.
.....................localvolume.local.storage.openshift.io/local-disks created
No resources found
No resources found
No resources found
No resources found
No resources found
No resources found
No resources found
No resources found
No resources found
No resources found
No resources found
No resources found
scp -o "StrictHostKeyChecking=no" ./scripts/install_ocs.sh root@192.168.7.77:~/
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 chmod +x install_ocs.sh
ssh -o "StrictHostKeyChecking=no" root@192.168.7.77 "DEBUG=false INSTALL_ODF=true ./install_ocs.sh"
Create New Project for container storage
Created project openshift-storage
project.project.openshift.io/openshift-storage annotated
namespace/openshift-storage labeled
Install Operator
operatorgroup.operators.coreos.com/ocs-operator-group created
subscription.operators.coreos.com/ocs-operator created
Wait for install succeeded.
No resources found in openshift-storage namespace.
.No resources found in openshift-storage namespace.
.No resources found in openshift-storage namespace.
.No resources found in openshift-storage namespace.
.No resources found in openshift-storage namespace.
.............node/odf0.ocp4.example.com tainted
node/odf1.ocp4.example.com tainted
node/odf2.ocp4.example.com tainted
storagecluster.ocs.openshift.io/ocs-storagecluster created
Wait for deploying succeeded.
...................................................................................................................................................................................................................................................................................